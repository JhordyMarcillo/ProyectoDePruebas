"use strict";(self.webpackChunkspa_modern_frontend=self.webpackChunkspa_modern_frontend||[]).push([[354],{5354:(Z,u,r)=>{r.r(u),r.d(u,{ProductosModule:()=>W});var p=r(177),e=r(9417),b=r(9012),G=r(9159),f=r(8834),N=r(9213),c=r(6467),h=r(9631),F=r(2798),l=r(5351),g=r(5416),R=r(6695),y=r(2042),E=r(9183),D=r(4823),T=r(6471),U=r(5596),t=r(4438),Y=r(5312),M=r(1626);let L=(()=>{class o{constructor(a){this.http=a,this.apiUrl=`${Y.c.apiUrl}/productos`}getProductos(a=1,i=10,n="",s=""){const d={page:a,limit:i};return n&&(d.search=n),s&&(d.categoria=s),this.http.get(this.apiUrl,{params:d})}getProducto(a){return this.http.get(`${this.apiUrl}/${a}`)}createProducto(a){return this.http.post(this.apiUrl,a)}updateProducto(a,i){return this.http.put(`${this.apiUrl}/${a}`,i)}deleteProducto(a){return this.http.delete(`${this.apiUrl}/${a}`)}getCategorias(){return this.http.get(`${this.apiUrl}/categorias`)}updateStock(a,i,n){return this.http.patch(`${this.apiUrl}/${a}/stock`,{cantidad:i,operacion:n})}static{this.\u0275fac=function(i){return new(i||o)(t.KVO(M.Qq))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var O=r(6600);function S(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," El nombre es requerido "),t.k0s())}function x(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," El precio de compra es requerido "),t.k0s())}function V(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Debe ser mayor a 0 "),t.k0s())}function X(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," El precio de venta es requerido "),t.k0s())}function B(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Debe ser mayor a 0 "),t.k0s())}function A(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," La cantidad es requerida "),t.k0s())}function J(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Debe ser mayor o igual a 0 "),t.k0s())}function z(o,m){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Debe ser mayor o igual a 0 "),t.k0s())}function H(o,m){1&o&&t.nrm(0,"mat-spinner",22)}function Q(o,m){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&o){const a=t.XpG();t.R7$(),t.JRh(a.isEditing?"Actualizar":"Crear")}}let v=(()=>{class o{constructor(a,i,n,s,d){this.fb=a,this.productoService=i,this.snackBar=n,this.dialogRef=s,this.data=d,this.isEditing=!1,this.isLoading=!1,this.isEditing=!!d,this.productoForm=this.createForm()}ngOnInit(){this.isEditing&&this.data&&this.productoForm.patchValue(this.data)}createForm(){return this.fb.group({nombre:["",[e.k0.required]],descripcion:[""],codigo:[""],categoria:[""],marca:[""],cantidad_stock:[0,[e.k0.required,e.k0.min(0)]],stock_minimo:[0,[e.k0.min(0)]],precio_compra:[0,[e.k0.required,e.k0.min(0)]],precio_venta:[0,[e.k0.required,e.k0.min(0)]],estado:["activo",[e.k0.required]]})}onSubmit(){if(this.productoForm.valid){this.isLoading=!0;const a=this.productoForm.value;(this.isEditing?this.productoService.updateProducto(this.data.id,a):this.productoService.createProducto(a)).subscribe({next:()=>{this.isLoading=!1,this.snackBar.open(`Producto ${this.isEditing?"actualizado":"creado"} correctamente`,"Cerrar",{duration:3e3}),this.dialogRef.close(!0)},error:n=>{this.isLoading=!1,this.snackBar.open("Error al guardar producto","Cerrar",{duration:3e3})}})}}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(e.ok),t.rXU(L),t.rXU(g.UG),t.rXU(l.CP),t.rXU(l.Vh))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-producto-form"]],decls:70,vars:14,consts:[["mat-dialog-title",""],[1,"producto-form",3,"formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","nombre","required",""],[4,"ngIf"],["matInput","","formControlName","codigo"],["matInput","","formControlName","categoria"],["matInput","","formControlName","marca"],["matInput","","formControlName","descripcion","rows","3"],["matInput","","type","number","formControlName","precio_compra","required",""],["matPrefix",""],["matInput","","type","number","formControlName","precio_venta","required",""],["matInput","","type","number","formControlName","cantidad_stock","required",""],["matInput","","type","number","formControlName","stock_minimo"],["formControlName","estado"],["value","activo"],["value","inactivo"],["align","end"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20",4,"ngIf"],["diameter","20"]],template:function(i,n){if(1&i&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.j41(2,"mat-dialog-content")(3,"form",1)(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t.EFF(7,"Nombre *"),t.k0s(),t.nrm(8,"input",4),t.DNE(9,S,2,0,"mat-error",5),t.k0s(),t.j41(10,"mat-form-field",3)(11,"mat-label"),t.EFF(12,"C\xf3digo"),t.k0s(),t.nrm(13,"input",6),t.k0s()(),t.j41(14,"div",2)(15,"mat-form-field",3)(16,"mat-label"),t.EFF(17,"Categor\xeda"),t.k0s(),t.nrm(18,"input",7),t.k0s(),t.j41(19,"mat-form-field",3)(20,"mat-label"),t.EFF(21,"Marca"),t.k0s(),t.nrm(22,"input",8),t.k0s()(),t.j41(23,"mat-form-field",3)(24,"mat-label"),t.EFF(25,"Descripci\xf3n"),t.k0s(),t.nrm(26,"textarea",9),t.k0s(),t.j41(27,"div",2)(28,"mat-form-field",3)(29,"mat-label"),t.EFF(30,"Precio de Compra *"),t.k0s(),t.nrm(31,"input",10),t.j41(32,"span",11),t.EFF(33,"$\xa0"),t.k0s(),t.DNE(34,x,2,0,"mat-error",5)(35,V,2,0,"mat-error",5),t.k0s(),t.j41(36,"mat-form-field",3)(37,"mat-label"),t.EFF(38,"Precio de Venta *"),t.k0s(),t.nrm(39,"input",12),t.j41(40,"span",11),t.EFF(41,"$\xa0"),t.k0s(),t.DNE(42,X,2,0,"mat-error",5)(43,B,2,0,"mat-error",5),t.k0s()(),t.j41(44,"div",2)(45,"mat-form-field",3)(46,"mat-label"),t.EFF(47,"Cantidad en Stock *"),t.k0s(),t.nrm(48,"input",13),t.DNE(49,A,2,0,"mat-error",5)(50,J,2,0,"mat-error",5),t.k0s(),t.j41(51,"mat-form-field",3)(52,"mat-label"),t.EFF(53,"Stock M\xednimo"),t.k0s(),t.nrm(54,"input",14),t.DNE(55,z,2,0,"mat-error",5),t.k0s()(),t.j41(56,"mat-form-field",3)(57,"mat-label"),t.EFF(58,"Estado"),t.k0s(),t.j41(59,"mat-select",15)(60,"mat-option",16),t.EFF(61,"Activo"),t.k0s(),t.j41(62,"mat-option",17),t.EFF(63,"Inactivo"),t.k0s()()()()(),t.j41(64,"mat-dialog-actions",18)(65,"button",19),t.bIt("click",function(){return n.onCancel()}),t.EFF(66,"Cancelar"),t.k0s(),t.j41(67,"button",20),t.bIt("click",function(){return n.onSubmit()}),t.DNE(68,H,1,0,"mat-spinner",21)(69,Q,2,1,"span",5),t.k0s()()),2&i){let s,d,C,k,P,$,j,I;t.R7$(),t.SpI("",n.isEditing?"Editar":"Nuevo"," Producto"),t.R7$(2),t.Y8G("formGroup",n.productoForm),t.R7$(6),t.Y8G("ngIf",null==(s=n.productoForm.get("nombre"))?null:s.hasError("required")),t.R7$(25),t.Y8G("ngIf",null==(d=n.productoForm.get("precio_compra"))?null:d.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(C=n.productoForm.get("precio_compra"))?null:C.hasError("min")),t.R7$(7),t.Y8G("ngIf",null==(k=n.productoForm.get("precio_venta"))?null:k.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(P=n.productoForm.get("precio_venta"))?null:P.hasError("min")),t.R7$(6),t.Y8G("ngIf",null==($=n.productoForm.get("cantidad_stock"))?null:$.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(j=n.productoForm.get("cantidad_stock"))?null:j.hasError("min")),t.R7$(5),t.Y8G("ngIf",null==(I=n.productoForm.get("stock_minimo"))?null:I.hasError("min")),t.R7$(10),t.Y8G("disabled",n.isLoading),t.R7$(2),t.Y8G("disabled",n.productoForm.invalid||n.isLoading),t.R7$(),t.Y8G("ngIf",n.isLoading),t.R7$(),t.Y8G("ngIf",!n.isLoading)}},dependencies:[p.bT,e.qT,e.me,e.Q0,e.BC,e.cb,e.YS,e.j4,e.JD,f.$z,c.rl,c.nJ,c.TL,c.JW,h.fg,F.VO,O.wT,l.BI,l.E7,l.Yi,E.LG],styles:[".producto-form[_ngcontent-%COMP%]{min-width:500px;padding:20px 0}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px}.form-row[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{flex:1}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}mat-dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;margin:0}mat-spinner[_ngcontent-%COMP%]{margin-right:8px}"]})}}return o})();const K=[{path:"",loadComponent:()=>Promise.all([r.e(76),r.e(234)]).then(r.bind(r,234)).then(o=>o.ProductosListComponent)},{path:"nuevo",component:v},{path:"editar/:id",component:v}];let W=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[p.MD,e.X1,b.iI.forChild(K),G.tP,f.Hl,N.m_,c.RG,h.fS,F.Ve,l.hM,g._T,R.Ou,y.NQ,E.D6,D.uc,T.YN,U.Hu]})}}return o})()}}]);